/**
 * @fileoverview report-issue.astro - P√°gina de reporte de problemas de TradeConnect
 * @description Formulario interactivo para reportar errores t√©cnicos, problemas de pago y otros inconvenientes.
 *
 * Arquitectura recomendada:
 * React (componentes interactivos)
 *   ‚Üì
 * Astro (routing y SSR)
 *   ‚Üì
 * shadcn/ui (componentes UI)
 *   ‚Üì
 * Tailwind CSS (estilos)
 *   ‚Üì
 * Radix UI (primitivos accesibles)
 *   ‚Üì
 * Lucide Icons (iconos)
 *
 * @author TradeConnect Team
 * @version 1.0.0
 */
---
import BaseLayout from '@/layouts/BaseLayout.astro';
---

<BaseLayout
  title="Reportar Problema - TradeConnect"
  description="Reporta problemas t√©cnicos, errores o inconvenientes con nuestra plataforma. Tu retroalimentaci√≥n nos ayuda a mejorar."
>
  <div class="report-issue-page">
    <section class="hero-section">
      <div class="container">
        <div class="breadcrumb">
          <a href="/" class="breadcrumb-link">‚Üê Volver al Inicio</a>
        </div>
        <h1>Reportar un Problema</h1>
        <p class="hero-description">
          Ay√∫danos a mejorar reportando errores o problemas que encuentres en la plataforma
        </p>
      </div>
    </section>

    <section class="report-section">
      <div class="container">
        <div class="report-grid">
          <div class="report-form-container">
            <h2>Detalles del problema</h2>
            <p class="form-intro">
              Por favor, proporciona la mayor cantidad de detalles posible para que podamos resolver el problema r√°pidamente.
            </p>

            <form class="report-form" id="reportIssueForm">
              <div class="form-group">
                <label for="name">Tu nombre *</label>
                <input type="text" id="name" name="name" required placeholder="Nombre completo" />
              </div>

              <div class="form-group">
                <label for="email">Correo electr√≥nico *</label>
                <input type="email" id="email" name="email" required placeholder="tu@email.com" />
              </div>

              <div class="form-group">
                <label for="issueType">Tipo de problema *</label>
                <select id="issueType" name="issueType" required>
                  <option value="">Selecciona el tipo de problema</option>
                  <option value="technical">Error t√©cnico</option>
                  <option value="payment">Problema de pago</option>
                  <option value="registration">Error de registro</option>
                  <option value="login">Problemas de inicio de sesi√≥n</option>
                  <option value="fel">Error de facturaci√≥n FEL</option>
                  <option value="certificate">Problemas con certificados</option>
                  <option value="qr">Problemas con c√≥digos QR</option>
                  <option value="ui">Problema de interfaz</option>
                  <option value="performance">Rendimiento/velocidad</option>
                  <option value="other">Otro</option>
                </select>
              </div>

              <div class="form-group">
                <label for="severity">Severidad *</label>
                <select id="severity" name="severity" required>
                  <option value="">Selecciona la severidad</option>
                  <option value="low">Baja - Problema menor</option>
                  <option value="medium">Media - Afecta funcionalidad</option>
                  <option value="high">Alta - Bloquea funcionalidad cr√≠tica</option>
                  <option value="critical">Cr√≠tica - Sistema no funciona</option>
                </select>
              </div>

              <div class="form-group">
                <label for="pageUrl">URL de la p√°gina (si aplica)</label>
                <input type="url" id="pageUrl" name="pageUrl" placeholder="https://tradeconnect.gt/..." />
              </div>

              <div class="form-group">
                <label for="title">T√≠tulo del problema *</label>
                <input type="text" id="title" name="title" required placeholder="Breve descripci√≥n del problema" />
              </div>

              <div class="form-group">
                <label for="description">Descripci√≥n detallada *</label>
                <textarea
                  id="description"
                  name="description"
                  required
                  rows="6"
                  placeholder="Describe el problema en detalle:&#10;- ¬øQu√© estabas intentando hacer?&#10;- ¬øQu√© esperabas que sucediera?&#10;- ¬øQu√© sucedi√≥ en realidad?&#10;- ¬øPasos para reproducir el problema?"
                ></textarea>
              </div>

              <div class="form-group">
                <label for="browser">Navegador y versi√≥n</label>
                <input type="text" id="browser" name="browser" placeholder="Ej: Chrome 120, Firefox 121, Safari 17" />
              </div>

              <div class="form-group">
                <label for="device">Dispositivo</label>
                <input type="text" id="device" name="device" placeholder="Ej: Windows 11, macOS Sonoma, Android 14" />
              </div>

              <div class="form-group">
                <label for="screenshot">Capturas de pantalla (opcional)</label>
                <input type="file" id="screenshot" name="screenshot" accept="image/*" multiple />
                <p class="field-help">Puedes adjuntar capturas de pantalla del problema</p>
              </div>

              <button type="submit" class="btn-primary">Enviar reporte</button>
            </form>
          </div>

          <div class="info-container">
            <div class="info-card">
              <div class="info-icon">‚ÑπÔ∏è</div>
              <h3>Informaci√≥n importante</h3>
              <ul>
                <li>Recibir√°s una confirmaci√≥n por correo electr√≥nico</li>
                <li>Nuestro equipo revisar√° tu reporte en 24-48 horas</li>
                <li>Te contactaremos si necesitamos m√°s informaci√≥n</li>
                <li>Te notificaremos cuando el problema est√© resuelto</li>
              </ul>
            </div>

            <div class="info-card">
              <div class="info-icon">üîí</div>
              <h3>Privacidad</h3>
              <p>
                Tu informaci√≥n personal se maneja de forma confidencial y solo se utiliza
                para resolver el problema reportado.
              </p>
            </div>

            <div class="info-card">
              <div class="info-icon">üìã</div>
              <h3>Consejos para un buen reporte</h3>
              <ul>
                <li>S√© espec√≠fico y detallado</li>
                <li>Incluye pasos para reproducir el error</li>
                <li>Adjunta capturas de pantalla si es posible</li>
                <li>Menciona el navegador y dispositivo</li>
                <li>Indica cu√°ndo ocurri√≥ el problema</li>
              </ul>
            </div>

            <div class="info-card help-card">
              <div class="info-icon">üí°</div>
              <h3>¬øNecesitas ayuda inmediata?</h3>
              <p>Si tienes una emergencia o necesitas asistencia urgente:</p>
              <div class="help-buttons">
                <a href="/contact" class="btn-outline">Contacto directo</a>
                <a href="/help" class="btn-outline">Centro de ayuda</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="status-section">
      <div class="container">
        <h2>Estado del sistema</h2>
        <div class="status-grid">
          <div class="status-item operational">
            <div class="status-indicator"></div>
            <div class="status-content">
              <h4>Plataforma principal</h4>
              <p>Operacional</p>
            </div>
          </div>
          <div class="status-item operational">
            <div class="status-indicator"></div>
            <div class="status-content">
              <h4>Procesamiento de pagos</h4>
              <p>Operacional</p>
            </div>
          </div>
          <div class="status-item operational">
            <div class="status-indicator"></div>
            <div class="status-content">
              <h4>Sistema FEL</h4>
              <p>Operacional</p>
            </div>
          </div>
          <div class="status-item operational">
            <div class="status-indicator"></div>
            <div class="status-content">
              <h4>Generaci√≥n de certificados</h4>
              <p>Operacional</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .report-issue-page {
    min-height: 100vh;
  }

  .hero-section {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    padding: var(--spacing-2xl) 0;
    text-align: center;
  }

  .breadcrumb {
    text-align: left;
    margin-bottom: var(--spacing-lg);
  }

  .breadcrumb-link {
    color: white;
    text-decoration: none;
    font-size: 0.95rem;
    opacity: 0.9;
    transition: opacity 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
  }

  .breadcrumb-link:hover {
    opacity: 1;
    text-decoration: underline;
  }

  .hero-section h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: var(--spacing-md);
    font-family: var(--font-secondary);
  }

  .hero-description {
    font-size: 1.25rem;
    max-width: 700px;
    margin: 0 auto;
    opacity: 0.9;
  }

  .report-section {
    padding: var(--spacing-2xl) 0;
    background: var(--background);
  }

  .report-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: var(--spacing-2xl);
  }

  .report-form-container h2 {
    color: var(--text-primary);
    font-family: var(--font-secondary);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
  }

  .form-intro {
    color: var(--text-secondary);
    margin-bottom: var(--spacing-xl);
    line-height: 1.6;
  }

  .report-form {
    background: white;
    padding: var(--spacing-xl);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
  }

  .form-group {
    margin-bottom: var(--spacing-lg);
  }

  .form-group label {
    display: block;
    color: var(--text-primary);
    font-weight: 600;
    margin-bottom: var(--spacing-sm);
    font-size: 0.9rem;
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: var(--spacing-md);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
    font-size: 1rem;
    font-family: var(--font-primary);
    transition: all 0.3s ease;
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(107, 30, 34, 0.1);
  }

  .form-group textarea {
    resize: vertical;
  }

  .field-help {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-top: var(--spacing-xs);
  }

  .btn-primary {
    width: 100%;
    padding: var(--spacing-md);
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    transition: background 0.3s ease;
  }

  .btn-primary:hover {
    background: var(--primary-dark);
  }

  .info-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
  }

  .info-card {
    background: white;
    padding: var(--spacing-lg);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
  }

  .info-icon {
    font-size: 2rem;
    margin-bottom: var(--spacing-sm);
  }

  .info-card h3 {
    color: var(--primary);
    font-size: 1.1rem;
    margin-bottom: var(--spacing-md);
    font-family: var(--font-secondary);
  }

  .info-card ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .info-card li {
    padding-left: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    position: relative;
    color: var(--text-secondary);
    font-size: 0.9rem;
  }

  .info-card li::before {
    content: "‚úì";
    color: var(--success);
    font-weight: bold;
    position: absolute;
    left: 0;
  }

  .info-card p {
    color: var(--text-secondary);
    line-height: 1.6;
    font-size: 0.9rem;
  }

  .help-card {
    background: linear-gradient(135deg, var(--primary-light) 0%, var(--surface) 100%);
    border: 1px solid var(--primary);
  }

  .help-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-md);
  }

  .btn-outline {
    padding: var(--spacing-sm) var(--spacing-md);
    background: white;
    color: var(--primary);
    border: 2px solid var(--primary);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
  }

  .btn-outline:hover {
    background: var(--primary);
    color: white;
  }

  .status-section {
    padding: var(--spacing-2xl) 0;
    background: white;
  }

  .status-section h2 {
    text-align: center;
    color: var(--text-primary);
    font-family: var(--font-secondary);
    margin-bottom: var(--spacing-xl);
    font-size: 1.75rem;
  }

  .status-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-lg);
  }

  .status-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    background: var(--surface);
    border-radius: var(--border-radius-lg);
    border-left: 4px solid var(--success);
  }

  .status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--success);
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .status-content h4 {
    color: var(--text-primary);
    margin-bottom: var(--spacing-xs);
    font-family: var(--font-secondary);
  }

  .status-content p {
    color: var(--success);
    font-size: 0.85rem;
    font-weight: 600;
  }

  @media (max-width: 968px) {
    .hero-section h1 {
      font-size: 2rem;
    }

    .hero-description {
      font-size: 1rem;
    }

    .report-grid {
      grid-template-columns: 1fr;
    }

    .status-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  document.getElementById('reportIssueForm')?.addEventListener('submit', function(e) {
    e.preventDefault();

    const severity = (document.getElementById('severity') as HTMLSelectElement)?.value;
    let message = 'Gracias por tu reporte. ';

    if (severity === 'critical' || severity === 'high') {
      message += 'Debido a la severidad del problema, nuestro equipo lo revisar√° inmediatamente.';
    } else {
      message += 'Nuestro equipo lo revisar√° en las pr√≥ximas 24-48 horas.';
    }

    alert(message);
    this.reset();
  });
</script>
